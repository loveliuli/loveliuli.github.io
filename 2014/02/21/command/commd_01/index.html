<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SED单行脚本快速参考 | 鹰击长空</title>
  <meta name="author" content="Copyright By Qun.Xue  版权所有">
  
  <meta name="description" content="where there is will there is way">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="SED单行脚本快速参考"/>
  <meta property="og:site_name" content="鹰击长空"/>

  
    <meta property="og:image" content="undefined"/>
  

 
  <link href="/favicon.ico" rel="icon" type="image/x-ico">
  <link rel="alternate" href="/atom.xml" title="鹰击长空" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">鹰击长空</a></h1>
  <h2><a href="/">Where there is a will, there is way。</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">存档</a></li>
    
      <li><a href="/about">关于我</a></li>
    
      <li><a href="/study">传送门</a></li>
    
 <li> <a title="把这个链接拖到你的Chrome收藏夹工具栏中" href='javascript:(function() {
	function c() {
		var e = document.createElement("link");
		e.setAttribute("type", "text/css");
		e.setAttribute("rel", "stylesheet");
		e.setAttribute("href", f);
		e.setAttribute("class", l);
		document.body.appendChild(e)
	}
 
	function h() {
		var e = document.getElementsByClassName(l);
		for (var t = 0; t < e.length; t++) {
			document.body.removeChild(e[t])
		}
	}
 
	function p() {
		var e = document.createElement("div");
		e.setAttribute("class", a);
		document.body.appendChild(e);
		setTimeout(function() {
			document.body.removeChild(e)
		}, 100)
	}
 
	function d(e) {
		return {
			height : e.offsetHeight,
			width : e.offsetWidth
		}
	}
 
	function v(i) {
		var s = d(i);
		return s.height > e && s.height < n && s.width > t && s.width < r
	}
 
	function m(e) {
		var t = e;
		var n = 0;
		while (!!t) {
			n += t.offsetTop;
			t = t.offsetParent
		}
		return n
	}
 
	function g() {
		var e = document.documentElement;
		if (!!window.innerWidth) {
			return window.innerHeight
		} else if (e && !isNaN(e.clientHeight)) {
			return e.clientHeight
		}
		return 0
	}
 
	function y() {
		if (window.pageYOffset) {
			return window.pageYOffset
		}
		return Math.max(document.documentElement.scrollTop, document.body.scrollTop)
	}
 
	function E(e) {
		var t = m(e);
		return t >= w && t <= b + w
	}
 
	function S() {
		var e = document.createElement("audio");
		e.setAttribute("class", l);
		e.src = i;
		e.loop = false;
		e.addEventListener("canplay", function() {
			setTimeout(function() {
				x(k)
			}, 500);
			setTimeout(function() {
				N();
				p();
				for (var e = 0; e < O.length; e++) {
					T(O[e])
				}
			}, 15500)
		}, true);
		e.addEventListener("ended", function() {
			N();
			h()
		}, true);
		e.innerHTML = " <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p> <p>";
		document.body.appendChild(e);
		e.play()
	}
 
	function x(e) {
		e.className += " " + s + " " + o
	}
 
	function T(e) {
		e.className += " " + s + " " + u[Math.floor(Math.random() * u.length)]
	}
 
	function N() {
		var e = document.getElementsByClassName(s);
		var t = new RegExp("\\b" + s + "\\b");
		for (var n = 0; n < e.length; ) {
			e[n].className = e[n].className.replace(t, "")
		}
	}
 
	var e = 30;
	var t = 30;
	var n = 350;
	var r = 350;
	var i = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3";
	var s = "mw-harlem_shake_me";
	var o = "im_first";
	var u = ["im_drunk", "im_baked", "im_trippin", "im_blown"];
	var a = "mw-strobe_light";
	var f = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css";
	var l = "mw_added_css";
	var b = g();
	var w = y();
	var C = document.getElementsByTagName("*");
	var k = null;
	for (var L = 0; L < C.length; L++) {
		var A = C[L];
		if (v(A)) {
			if (E(A)) {
				k = A;
				break
			}
		}
	}
	if (A === null) {
		console.warn("Could not find a node of the right size. Please try a different page.");
		return
	}
	c();
	S();
	var O = [];
	for (var L = 0; L < C.length; L++) {
		var A = C[L];
		if (v(A)) {
			O.push(A)
		}
	}
})()    '>High一下</a> </li>   
    
   <li> <a href="/atom.xml">RSS</a> </li> 
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-02-21T08:36:12.000Z"><a href="/2014/02/21/command/commd_01/">2月 21 2014</a></time>
      
      
  
    <h1 class="title">SED单行脚本快速参考</h1>
  

    </header>
    <div class="entry">
      
        <p>SED单行脚本快速参考（Unix 流编辑器） 整理：Eric Pement  - 电邮：pemente[at]northpark[dot]edu  <a id="more"></a> </p>
<h3 id="-">在每一行后面增加一空行</h3>
<pre><code>sed G
</code></pre><h3 id="-">将原来的所有空行删除并在每一行后面增加一空行。</h3>
<h3 id="-">这样在输出的文本中每一行后面将有且只有一空行。</h3>
<pre><code>sed &#39;/^$/d;G&#39;
</code></pre><h3 id="-">在每一行后面增加两行空行</h3>
<pre><code>sed &#39;G;G&#39;
</code></pre><h3 id="-">将第一个脚本所产生的所有空行删除（即删除所有偶数行）</h3>
<pre><code>sed &#39;n;d&#39;
</code></pre><h3 id="-regex-">在匹配式样“regex”的行之前插入一空行</h3>
<pre><code>sed &#39;/regex/{x;p;x;}&#39;
</code></pre><h3 id="-regex-">在匹配式样“regex”的行之后插入一空行</h3>
<pre><code>sed &#39;/regex/G&#39;
</code></pre><h3 id="-regex-">在匹配式样“regex”的行之前和之后各插入一空行</h3>
<pre><code>sed &#39;/regex/{x;p;x;G;}&#39;
</code></pre><h2 id="-">编号：</h2>
<h3 id="-">为文件中的每一行进行编号（简单的左对齐方式）。这里使用了“制表符”</h3>
<h3 id="-tab-t-">（tab，见本文末尾关于&#39;\t&#39;的用法的描述）而不是空格来对齐边缘。</h3>
<pre><code>sed = filename | sed &#39;N;s/\n/\t/&#39;
</code></pre><h3 id="-">对文件中的所有行编号（行号在左，文字右端对齐）。</h3>
<pre><code>sed = filename | sed &#39;N; s/^/     /; s/ *\(.\{6,\}\)\n/\1  /&#39;
</code></pre><h3 id="-">对文件中的所有行编号，但只显示非空白行的行号。</h3>
<pre><code>sed &#39;/./=&#39; filename | sed &#39;/./N; s/\n/ /&#39;
</code></pre><h3 id="-wc-l-">计算行数 （模拟 &quot;wc -l&quot;）</h3>
<pre><code>sed -n &#39;$=&#39;
</code></pre><h2 id="-">文本转换和替代：</h2>
<h3 id="unix-dos-cr-lf-unix-">Unix环境：转换DOS的新行符（CR/LF）为Unix格式。</h3>
<pre><code>sed &#39;s/.$//&#39;                     # 假设所有行以CR/LF结束
sed &#39;s/^M$//&#39;                    # 在bash/tcsh中，将按Ctrl-M改为按Ctrl-V
sed &#39;s/\x0D$//&#39;                  # ssed、gsed 3.02.80，及更高版本
</code></pre><h3 id="unix-unix-lf-dos-">Unix环境：转换Unix的新行符（LF）为DOS格式。</h3>
<pre><code>sed &quot;s/$/`echo -e \\\r`/&quot;        # 在ksh下所使用的命令
sed &#39;s/$&#39;&quot;/`echo \\\r`/&quot;         # 在bash下所使用的命令
sed &quot;s/$/`echo \\\r`/&quot;           # 在zsh下所使用的命令
sed &#39;s/$/\r/&#39;                    # gsed 3.02.80 及更高版本
</code></pre><h3 id="dos-unix-lf-dos-">DOS环境：转换Unix新行符（LF）为DOS格式。</h3>
<pre><code>sed &quot;s/$//&quot;                      # 方法 1
sed -n p                         # 方法 2
</code></pre><h3 id="dos-dos-cr-lf-unix-">DOS环境：转换DOS新行符（CR/LF）为Unix格式。</h3>
<h3 id="-unxutils-sed-4-0-7-unxutils-">下面的脚本只对UnxUtils sed 4.0.7 及更高版本有效。要识别UnxUtils版本的</h3>
<h3 id="sed-text-help-">sed可以通过其特有的“--text”选项。你可以使用帮助选项（“--help”）看</h3>
<h3 id="-text-unxutils-dos">其中有无一个“--text”项以此来判断所使用的是否是UnxUtils版本。其它DOS</h3>
<h3 id="-sed-tr-">版本的的sed则无法进行这一转换。但可以用“tr”来实现这一转换。</h3>
<pre><code>sed &quot;s/\r//&quot; infile &gt;outfile     # UnxUtils sed v4.0.7 或更高版本
tr -d \r &lt;infile &gt;outfile        # GNU tr 1.22 或更高版本
</code></pre><h3 id="-">将每一行前导的“空白字符”（空格，制表符）删除</h3>
<h3 id="-">使之左对齐</h3>
<pre><code>sed &#39;s/^[ \t]*//&#39;                # 见本文末尾关于&#39;\t&#39;用法的描述
</code></pre><h3 id="-">将每一行拖尾的“空白字符”（空格，制表符）删除</h3>
<pre><code>sed &#39;s/[ \t]*$//&#39;                # 见本文末尾关于&#39;\t&#39;用法的描述
</code></pre><h3 id="-">将每一行中的前导和拖尾的空白字符删除</h3>
<pre><code>sed &#39;s/^[ \t]*//;s/[ \t]*$//&#39;
</code></pre><h3 id="-5-5-">在每一行开头处插入5个空格（使全文向右移动5个字符的位置）</h3>
<pre><code>sed &#39;s/^/     /&#39;
</code></pre><h3 id="-79-">以79个字符为宽度，将所有文本右对齐</h3>
<pre><code>sed -e :a -e &#39;s/^.\{1,78\}$/ &amp;/;ta&#39;  # 78个字符外加最后的一个空格
</code></pre><h3 id="-79-1-">以79个字符为宽度，使所有文本居中。在方法1中，为了让文本居中每一行的前</h3>
<h3 id="-2-">头和后头都填充了空格。 在方法2中，在居中文本的过程中只在文本的前面填充</h3>
<h3 id="-">空格，并且最终这些空格将有一半会被删除。此外每一行的后头并未填充空格。</h3>
<pre><code>sed  -e :a -e &#39;s/^.\{1,77\}$/ &amp; /;ta&#39;                     # 方法1
sed  -e :a -e &#39;s/^.\{1,77\}$/ &amp;/;ta&#39; -e &#39;s/\( *\)\1/\1/&#39;  # 方法2
</code></pre><h4 id="-foo-foo-bar-">在每一行中查找字串“foo”，并将找到的“foo”替换为“bar”</h4>
<pre><code>sed &#39;s/foo/bar/&#39;                 # 只替换每一行中的第一个“foo”字串
sed &#39;s/foo/bar/4&#39;                # 只替换每一行中的第四个“foo”字串
sed &#39;s/foo/bar/g&#39;                # 将每一行中的所有“foo”都换成“bar”
sed &#39;s/\(.*\)foo\(.*foo\)/\1bar\2/&#39; # 替换倒数第二个“foo”
sed &#39;s/\(.*\)foo/\1bar/&#39;            # 替换最后一个“foo”
</code></pre><h3 id="-baz-foo-bar-">只在行中出现字串“baz”的情况下将“foo”替换成“bar”</h3>
<pre><code>sed &#39;/baz/s/foo/bar/g&#39;
</code></pre><h3 id="-foo-bar-baz-">将“foo”替换成“bar”，并且只在行中未出现字串“baz”的情况下替换</h3>
<pre><code>sed &#39;/baz/!s/foo/bar/g&#39;
</code></pre><h3 id="-scarlet-ruby-puce-red-">不管是“scarlet”“ruby”还是“puce”，一律换成“red”</h3>
<pre><code>sed &#39;s/scarlet/red/g;s/ruby/red/g;s/puce/red/g&#39;  #对多数的sed都有效
gsed &#39;s/scarlet\|ruby\|puce/red/g&#39;               # 只对GNU sed有效
</code></pre><h3 id="-tac-">倒置所有行，第一行成为最后一行，依次类推（模拟“tac”）。</h3>
<h3 id="-hhsed-v1-5-">由于某些原因，使用下面命令时HHsed v1.5会将文件中的空行删除</h3>
<pre><code>sed &#39;1!G;h;$!d&#39;               # 方法1
sed -n &#39;1!G;h;$p&#39;             # 方法2
</code></pre><h3 id="-rev-">将行中的字符逆序排列，第一个字成为最后一字，……（模拟“rev”）</h3>
<pre><code>sed &#39;/\n/!G;s/\(.\)\(.*\n\)/&amp;\2\1/;//D;s/.//&#39;
</code></pre><h3 id="-paste-">将每两行连接成一行（类似“paste”）</h3>
<pre><code>sed &#39;$!N;s/\n/ /&#39;
</code></pre><h3 id="-">如果当前行以反斜杠“\”结束，则将下一行并到当前行末尾</h3>
<h3 id="-">并去掉原来行尾的反斜杠</h3>
<pre><code>sed -e :a -e &#39;/\\$/N; s/\\\n//; ta&#39;
</code></pre><h3 id="-">如果当前行以等号开头，将当前行并到上一行末尾</h3>
<h3 id="-">并以单个空格代替原来行头的“=”</h3>
<pre><code>sed -e :a -e &#39;$!N;s/\n=/ /;ta&#39; -e &#39;P;D&#39;
</code></pre><h3 id="-1234567-1-234-567-">为数字字串增加逗号分隔符号，将“1234567”改为“1,234,567”</h3>
<pre><code>gsed &#39;:a;s/\B[0-9]\{3\}\&gt;/,&amp;/;ta&#39;                     # GNU sed
sed -e :a -e &#39;s/\(.*[0-9]\)\([0-9]\{3\}\)/\1,\2/;ta&#39;  # 其他sed
</code></pre><h3 id="-gnu-sed-">为带有小数点和负号的数值增加逗号分隔符（GNU sed）</h3>
<pre><code>gsed -r &#39;:a;s/(^|[^0-9.])([0-9]+)([0-9]{3})/\1\2,\3/g;ta&#39;
</code></pre><h3 id="-5-5-10-15-20-">在每5行后增加一空白行 （在第5，10，15，20，等行后增加一空白行）</h3>
<pre><code>gsed &#39;0~5G&#39;                      # 只对GNU sed有效
sed &#39;n;n;n;n;G;&#39;                 # 其他sed
</code></pre><h2 id="-">选择性地显示特定行：</h2>
<h3 id="-10-head-">显示文件中的前10行 （模拟“head”的行为）</h3>
<pre><code>sed 10q
</code></pre><h3 id="-head-1-">显示文件中的第一行 （模拟“head -1”命令）</h3>
<pre><code>sed q
</code></pre><h3 id="-10-tail-">显示文件中的最后10行 （模拟“tail”）</h3>
<pre><code>sed -e :a -e &#39;$q;N;11,$D;ba&#39;
</code></pre><h4 id="-2-tail-2-">显示文件中的最后2行（模拟“tail -2”命令）</h4>
<pre><code>sed &#39;$!N;$!D&#39;
</code></pre><h3 id="-tail-1-">显示文件中的最后一行（模拟“tail -1”）</h3>
<pre><code>sed &#39;$!d&#39;                        # 方法1
sed -n &#39;$p&#39;                      # 方法2
</code></pre><h3 id="-">显示文件中的倒数第二行</h3>
<pre><code>sed -e &#39;$!{h;d;}&#39; -e x              # 当文件中只有一行时，输入空行
sed -e &#39;1{$q;}&#39; -e &#39;$!{h;d;}&#39; -e x  # 当文件中只有一行时，显示该行
sed -e &#39;1{$d;}&#39; -e &#39;$!{h;d;}&#39; -e x  # 当文件中只有一行时，不输出
</code></pre><h3 id="-grep-">只显示匹配正则表达式的行（模拟“grep”）</h3>
<pre><code>sed -n &#39;/regexp/p&#39;               # 方法1
sed &#39;/regexp/!d&#39;                 # 方法2
</code></pre><h3 id="-grep-v-">只显示“不”匹配正则表达式的行（模拟“grep -v”）</h3>
<pre><code>sed -n &#39;/regexp/!p&#39;              # 方法1，与前面的命令相对应
sed &#39;/regexp/d&#39;                  # 方法2，类似的语法
</code></pre><h3 id="-regexp-">查找“regexp”并将匹配行的上一行显示出来，但并不显示匹配行</h3>
<pre><code>sed -n &#39;/regexp/{g;1!p;};h&#39;
</code></pre><h3 id="-regexp-">查找“regexp”并将匹配行的下一行显示出来，但并不显示匹配行</h3>
<pre><code>sed -n &#39;/regexp/{n;p;}&#39;
</code></pre><h3 id="-regexp-regexp-">显示包含“regexp”的行及其前后行，并在第一行之前加上“regexp”所</h3>
<h3 id="-grep-a1-b1-">在行的行号 （类似“grep -A1 -B1”）</h3>
<pre><code>sed -n -e &#39;/regexp/{=;x;1!p;g;$!N;p;D;}&#39; -e h
</code></pre><h3 id="-aaa-bbb-ccc-">显示包含“AAA”、“BBB”或“CCC”的行（任意次序）</h3>
<pre><code>sed &#39;/AAA/!d; /BBB/!d; /CCC/!d&#39;  # 字串的次序不影响结果
</code></pre><h3 id="-aaa-bbb-ccc-">显示包含“AAA”、“BBB”和“CCC”的行（固定次序）</h3>
<pre><code>sed &#39;/AAA.*BBB.*CCC/!d&#39;
</code></pre><h3 id="-aaa-bbb-ccc-egrep-">显示包含“AAA”“BBB”或“CCC”的行 （模拟“egrep”）</h3>
<pre><code>sed -e &#39;/AAA/b&#39; -e &#39;/BBB/b&#39; -e &#39;/CCC/b&#39; -e d    # 多数sed
gsed &#39;/AAA\|BBB\|CCC/!d&#39;                        # 对GNU sed有效
</code></pre><h3 id="-aaa-">显示包含“AAA”的段落 （段落间以空行分隔）</h3>
<h3 id="hhsed-v1-5-x-g-3-">HHsed v1.5 必须在“x;”后加入“G;”，接下来的3个脚本都是这样</h3>
<pre><code>sed -e &#39;/./{H;$!d;}&#39; -e &#39;x;/AAA/!d;&#39;
</code></pre><h3 id="-aaa-bbb-ccc-">显示包含“AAA”“BBB”和“CCC”三个字串的段落 （任意次序）</h3>
<pre><code>sed -e &#39;/./{H;$!d;}&#39; -e &#39;x;/AAA/!d;/BBB/!d;/CCC/!d&#39;
</code></pre><h3 id="-aaa-bbb-ccc-">显示包含“AAA”、“BBB”、“CCC”三者中任一字串的段落 （任意次序）</h3>
<pre><code>sed -e &#39;/./{H;$!d;}&#39; -e &#39;x;/AAA/b&#39; -e &#39;/BBB/b&#39; -e &#39;/CCC/b&#39; -e d
gsed &#39;/./{H;$!d;};x;/AAA\|BBB\|CCC/b;d&#39;         # 只对GNU sed有效
</code></pre><h3 id="-65-">显示包含65个或以上字符的行</h3>
<pre><code>sed -n &#39;/^.\{65\}/p&#39;
</code></pre><h3 id="-65-">显示包含65个以下字符的行</h3>
<pre><code>sed -n &#39;/^.\{65\}/!p&#39;            # 方法1，与上面的脚本相对应
sed &#39;/^.\{65\}/d&#39;                # 方法2，更简便一点的方法
</code></pre><h3 id="-">显示部分文本——从包含正则表达式的行开始到最后一行结束</h3>
<pre><code>sed -n &#39;/regexp/,$p&#39;
</code></pre><h3 id="-8-12-8-12-">显示部分文本——指定行号范围（从第8至第12行，含8和12行）</h3>
<pre><code>sed -n &#39;8,12p&#39;                   # 方法1
sed &#39;8,12!d&#39;                     # 方法2
</code></pre><h3 id="-52-">显示第52行</h3>
<pre><code>sed -n &#39;52p&#39;                     # 方法1
sed &#39;52!d&#39;                       # 方法2
sed &#39;52q;d&#39;                      # 方法3, 处理大文件时更有效率
</code></pre><h3 id="-3-7-">从第3行开始，每7行显示一次</h3>
<pre><code>gsed -n &#39;3~7p&#39;                   # 只对GNU sed有效
sed -n &#39;3,${p;n;n;n;n;n;n;}&#39;     # 其他sed
</code></pre><h3 id="-">显示两个正则表达式之间的文本（包含）</h3>
<pre><code>sed -n &#39;/Iowa/,/Montana/p&#39;       # 区分大小写方式
</code></pre><h2 id="-">选择性地删除特定行：</h2>
<h3 id="-">显示通篇文档，除了两个正则表达式之间的内容</h3>
<pre><code>sed &#39;/Iowa/,/Montana/d&#39;
</code></pre><h3 id="-uniq-">删除文件中相邻的重复行（模拟“uniq”）</h3>
<h3 id="-">只保留重复行中的第一行，其他行删除</h3>
<pre><code>sed &#39;$!N; /^\(.*\)\n\1$/!P; D&#39;
</code></pre><h3 id="-hold-space-">删除文件中的重复行，不管有无相邻。注意hold space所能支持的缓存</h3>
<h3 id="-gnu-sed-">大小，或者使用GNU sed。</h3>
<pre><code>sed -n &#39;G; s/\n/&amp;&amp;/; /^\([ -~]*\n\).*\n\1/d; s/\n//; h; P&#39;
</code></pre><h3 id="-uniq-d-">删除除重复行外的所有行（模拟“uniq -d”）</h3>
<pre><code>sed &#39;$!N; s/^\(.*\)\n\1$/\1/; t; D&#39;
</code></pre><h3 id="-10-">删除文件中开头的10行</h3>
<pre><code>sed &#39;1,10d&#39;
</code></pre><h3 id="-">删除文件中的最后一行</h3>
<pre><code>sed &#39;$d&#39;
</code></pre><h3 id="-">删除文件中的最后两行</h3>
<pre><code>sed &#39;N;$!P;$!D;$d&#39;
</code></pre><h3 id="-10-">删除文件中的最后10行</h3>
<pre><code>sed -e :a -e &#39;$d;N;2,10ba&#39; -e &#39;P;D&#39;   # 方法1
sed -n -e :a -e &#39;1,10!{P;N;D;};N;ba&#39;  # 方法2
</code></pre><h3 id="-8-">删除8的倍数行</h3>
<pre><code>gsed &#39;0~8d&#39;                           # 只对GNU sed有效
sed &#39;n;n;n;n;n;n;n;d;&#39;                # 其他sed
</code></pre><h3 id="-">删除匹配式样的行</h3>
<pre><code>sed &#39;/pattern/d&#39;                      # 删除含pattern的行。当然pattern
                                   # 可以换成任何有效的正则表达式
</code></pre><h3 id="-grep-">删除文件中的所有空行（与“grep &#39;.&#39; ”效果相同）</h3>
<pre><code>sed &#39;/^$/d&#39;                           # 方法1
sed &#39;/./!d&#39;                           # 方法2
</code></pre><h3 id="-">只保留多个相邻空行的第一行。并且删除文件顶部和尾部的空行。</h3>
<h3 id="-cat-s-">（模拟“cat -s”）</h3>
<pre><code>sed &#39;/./,/^$/!d&#39;        #方法1，删除文件顶部的空行，允许尾部保留一空行
sed &#39;/^$/N;/\n$/D&#39;      #方法2，允许顶部保留一空行，尾部不留空行
</code></pre><h3 id="-">只保留多个相邻空行的前两行。</h3>
<pre><code>sed &#39;/^$/N;/\n$/N;//D&#39;
</code></pre><h3 id="-">删除文件顶部的所有空行</h3>
<pre><code>sed &#39;/./,$!d&#39;
</code></pre><h3 id="-">删除文件尾部的所有空行</h3>
<pre><code>sed -e :a -e &#39;/^\n*$/{$d;N;ba&#39; -e &#39;}&#39;  # 对所有sed有效
sed -e :a -e &#39;/^\n*$/N;/\n$/ba&#39;        # 同上，但只对 gsed 3.02.*有效
</code></pre><h3 id="-">删除每个段落的最后一行</h3>
<pre><code>sed -n &#39;/^$/{p;h;};/./{x;/./p;}&#39;
</code></pre><h2 id="-">特殊应用：</h2>
<h3 id="-man-page-nroff-unix-system-v-bash-shell-">移除手册页（man page）中的nroff标记。在Unix System V或bash shell下使</h3>
<h3 id="-echo-e-">用&#39;echo&#39;命令时可能需要加上 -e 选项。</h3>
<pre><code>sed &quot;s/.`echo \\\b`//g&quot;    # 外层的双括号是必须的（Unix环境）
sed &#39;s/.^H//g&#39;             # 在bash或tcsh中, 按 Ctrl-V 再按 Ctrl-H
sed &#39;s/.\x08//g&#39;           # sed 1.5，GNU sed，ssed所使用的十六进制的表示方法
</code></pre><h3 id="-e-mail-">提取新闻组或 e-mail 的邮件头</h3>
<pre><code>sed &#39;/^$/q&#39;                # 删除第一行空行后的所有内容
</code></pre><h3 id="-e-mail-">提取新闻组或 e-mail 的正文部分</h3>
<pre><code>sed &#39;1,/^$/d&#39;              # 删除第一行空行之前的所有内容
</code></pre><h3 id="-subject-subject-">从邮件头提取“Subject”（标题栏字段），并移除开头的“Subject:”字样</h3>
<pre><code>sed &#39;/^Subject: */!d; s///;q&#39;
</code></pre><h3 id="-">从邮件头获得回复地址</h3>
<pre><code>sed &#39;/^Reply-To:/q; /^From:/h; /./d;g;q&#39;
</code></pre><h3 id="-">获取邮件地址。在上一个脚本所产生的那一行邮件头的基础上进一步的将非电邮</h3>
<h3 id="-">地址的部分剃除。（见上一脚本）</h3>
<pre><code>sed &#39;s/ *(.*)//; s/&gt;.*//; s/.*[:&lt;] *//&#39;
</code></pre><h3 id="-">在每一行开头加上一个尖括号和空格（引用信息）</h3>
<pre><code>sed &#39;s/^/&gt; /&#39;
</code></pre><h3 id="-">将每一行开头处的尖括号和空格删除（解除引用）</h3>
<pre><code>sed &#39;s/^&gt; //&#39;
</code></pre><h3 id="-html-">移除大部分的HTML标签（包括跨行标签）</h3>
<pre><code>sed -e :a -e &#39;s/&lt;[^&gt;]*&gt;//g;/&lt;/N;//ba&#39;
</code></pre><h3 id="-uuencode-uuencode-">将分成多卷的uuencode文件解码。移除文件头信息，只保留uuencode编码部分。</h3>
<h3 id="-sed-">文件必须以特定顺序传给sed。下面第一种版本的脚本可以直接在命令行下输入；</h3>
<h3 id="-shell-rahul-dhesi-">第二种版本则可以放入一个带执行权限的shell脚本中。（由Rahul Dhesi的一</h3>
<h3 id="-">个脚本修改而来。）</h3>
<pre><code>sed &#39;/^end/,/^begin/d&#39; file1 file2 ... fileX | uudecode   # vers. 1
sed &#39;/^end/,/^begin/d&#39; &quot;$@&quot; | uudecode                    # vers. 2
</code></pre><h3 id="-gnu-sed-">将文件中的段落以字母顺序排序。段落间以（一行或多行）空行分隔。GNU sed使用</h3>
<h3 id="-v-">字元“\v”来表示垂直制表符，这里用它来作为换行符的占位符——当然你也可以</h3>
<h3 id="-">用其他未在文件中使用的字符来代替它。</h3>
<pre><code>sed &#39;/./{H;d;};x;s/\n/={NL}=/g&#39; file | sort | sed &#39;1s/={NL}=//;s/={NL}=/\n/g&#39;
gsed &#39;/./{H;d};x;y/\n/\v/&#39; file | sort | sed &#39;1s/\v//;y/\v/\n/&#39;
</code></pre><h3 id="-txt-zip-">分别压缩每个.TXT文件，压缩后删除原来的文件并将压缩后的.ZIP文件</h3>
<h3 id="-dos-dir-b-">命名为与原来相同的名字（只是扩展名不同）。（DOS环境：“dir /b”</h3>
<h3 id="-">显示不带路径的文件名）。</h3>
<pre><code>echo @echo off &gt;zipup.bat
dir /b *.txt | sed &quot;s/^\(.*\)\.TXT/pkzip -mo \1 \1.TXT/&quot; &gt;&gt;zipup.bat
</code></pre><p>使用SED：Sed接受一个或多个编辑命令，并且每读入一行后就依次应用这些命令。
当读入第一行输入后，sed对其应用所有的命令，然后将结果输出。接着再读入第二
行输入，对其应用所有的命令……并重复这个过程。上一个例子中sed由标准输入设
备（即命令解释器，通常是以管道输入的形式）获得输入。在命令行给出一个或多
个文件名作为参数时，这些文件取代标准输入设备成为sed的输入。sed的输出将被
送到标准输出（显示器）。因此：</p>
<pre><code>cat filename | sed &#39;10q&#39;         # 使用管道输入
sed &#39;10q&#39; filename               # 同样效果，但不使用管道输入
sed &#39;10q&#39; filename &gt; newfile     # 将输出转移（重定向）到磁盘上
</code></pre><p>要了解sed命令的使用说明，包括如何通过脚本文件（而非从命令行）来使用这些命
令，请参阅《sed &amp; awk》第二版，作者Dale Dougherty和Arnold Robbins
（O&#39;Reilly，1997；<a href="http://www.ora.com），《UNIX" target="_blank">http://www.ora.com），《UNIX</a> Text Processing》，作者
Dale Dougherty和Tim O&#39;Reilly（Hayden Books，1987）或者是Mike Arst写的教
程——压缩包的名称是“U-SEDIT2.ZIP”（在许多站点上都找得到）。要发掘sed
的潜力，则必须对“正则表达式”有足够的理解。正则表达式的资料可以看
《Mastering Regular Expressions》作者Jeffrey Friedl（O&#39;reilly 1997）。
Unix系统所提供的手册页（“man”）也会有所帮助（试一下这些命令
“man sed”、“man regexp”，或者看“man ed”中关于正则表达式的部分），但
手册提供的信息比较“抽象”——这也是它一直为人所诟病的。不过，它本来就不
是用来教初学者如何使用sed或正则表达式的教材，而只是为那些熟悉这些工具的人
提供的一些文本参考。</p>
<p>括号语法：前面的例子对sed命令基本上都使用单引号（&#39;...&#39;）而非双引号
（&quot;...&quot;）这是因为sed通常是在Unix平台上使用。单引号下，Unix的shell（命令
解释器）不会对美元符（$）和后引号（<code>...</code>）进行解释和执行。而在双引号下
美元符会被展开为变量或参数的值，后引号中的命令被执行并以输出的结果代替
后引号中的内容。而在“csh”及其衍生的shell中使用感叹号（!）时需要在其前
面加上转义用的反斜杠（就像这样：!）以保证上面所使用的例子能正常运行
（包括使用单引号的情况下）。DOS版本的Sed则一律使用双引号（&quot;...&quot;）而不是
引号来圈起命令。</p>
<p>&#39;\t&#39;的用法：为了使本文保持行文简洁，我们在脚本中使用&#39;\t&#39;来表示一个制表
符。但是现在大部分版本的sed还不能识别&#39;\t&#39;的简写方式，因此当在命令行中为
脚本输入制表符时，你应该直接按TAB键来输入制表符而不是输入&#39;\t&#39;。下列的工
具软件都支持&#39;\t&#39;做为一个正则表达式的字元来表示制表符：awk、perl、HHsed、
sedmod以及GNU sed v3.02.80。</p>
<p>不同版本的SED：不同的版本间的sed会有些不同之处，可以想象它们之间在语法上
会有差异。具体而言，它们中大部分不支持在编辑命令中间使用标签（:name）或分
支命令（b,t），除非是放在那些的末尾。这篇文档中我们尽量选用了可移植性较高
的语法，以使大多数版本的sed的用户都能使用这些脚本。不过GNU版本的sed允许使
用更简洁的语法。想像一下当读者看到一个很长的命令时的心情：</p>
<pre><code>sed -e &#39;/AAA/b&#39; -e &#39;/BBB/b&#39; -e &#39;/CCC/b&#39; -e d
</code></pre><p>好消息是GNU sed能让命令更紧凑：</p>
<pre><code>sed &#39;/AAA/b;/BBB/b;/CCC/b;d&#39;      # 甚至可以写成
sed &#39;/AAA\|BBB\|CCC/b;d&#39;
</code></pre><p>此外，请注意虽然许多版本的sed接受象“/one/ s/RE1/RE2/”这种在&#39;s&#39;前带有空
格的命令，但这些版本中有些却不接受这样的命令:“/one/! s/RE1/RE2/”。这时
只需要把中间的空格去掉就行了。</p>
<p>速度优化：当由于某种原因（比如输入文件较大、处理器或硬盘较慢等）需要提高
命令执行速度时，可以考虑在替换命令（“s/.../.../”）前面加上地址表达式来
提高速度。举例来说：</p>
<pre><code>sed &#39;s/foo/bar/g&#39; filename         # 标准替换命令
sed &#39;/foo/ s/foo/bar/g&#39; filename   # 速度更快
sed &#39;/foo/ s//bar/g&#39; filename      # 简写形式
</code></pre><p>当只需要显示文件的前面的部分或需要删除后面的内容时，可以在脚本中使用“q”
命令（退出命令）。在处理大的文件时，这会节省大量时间。因此：</p>
<pre><code>sed -n &#39;45,50p&#39; filename           # 显示第45到50行
sed -n &#39;51q;45,50p&#39; filename       # 一样，但快得多
</code></pre>
      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/命令/">命令</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/command/">command</a>
  </div>

        <!-- Baidu Button BEGIN -->
<div id="bdshare" class="bdshare_t bds_tools_32 get-codes-bdshare">
<a class="bds_tsina"></a>
<a class="bds_qzone"></a>
<a class="bds_tqq"></a>
<a class="bds_renren"></a>
<a class="bds_t163"></a>
<span class="bds_more"></span>
<a class="shareCount"></a>
</div>
<script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=6861768" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
</script>
<!-- Baidu Button END -->
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"loveliuli"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->
</section>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:loveliuli.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/Markdown/">Markdown</a><small>1</small></li>
  
    <li><a href="/categories/php/">php</a><small>2</small></li>
  
    <li><a href="/categories/puppet/">puppet</a><small>1</small></li>
  
    <li><a href="/categories/优化/">优化</a><small>1</small></li>
  
    <li><a href="/categories/其他/">其他</a><small>1</small></li>
  
    <li><a href="/categories/命令/">命令</a><small>1</small></li>
  
    <li><a href="/categories/基础/">基础</a><small>1</small></li>
  
    <li><a href="/categories/安全/">安全</a><small>1</small></li>
  
    <li><a href="/categories/工具/">工具</a><small>1</small></li>
  
    <li><a href="/categories/应用/">应用</a><small>3</small></li>
  
    <li><a href="/categories/数据库/">数据库</a><small>1</small></li>
  
    <li><a href="/categories/生活/">生活</a><small>1</small></li>
  
    <li><a href="/categories/生活领悟/">生活领悟</a><small>1</small></li>
  
    <li><a href="/categories/监控/">监控</a><small>6</small></li>
  
    <li><a href="/categories/网络/">网络</a><small>1</small></li>
  
    <li><a href="/categories/脚本/">脚本</a><small>1</small></li>
  
    <li><a href="/categories/虚拟化/">虚拟化</a><small>1</small></li>
  
    <li><a href="/categories/集群/">集群</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Performance tuning/" style="font-size: 10.00px;">Performance tuning</a><a href="/tags/application/" style="font-size: 10.00px;">application</a><a href="/tags/base/" style="font-size: 10.00px;">base</a><a href="/tags/cluster/" style="font-size: 10.00px;">cluster</a><a href="/tags/command/" style="font-size: 10.00px;">command</a><a href="/tags/database/" style="font-size: 10.00px;">database</a><a href="/tags/life/" style="font-size: 10.00px;">life</a><a href="/tags/markdown/" style="font-size: 15.00px;">markdown</a><a href="/tags/monitor/" style="font-size: 20.00px;">monitor</a><a href="/tags/network/" style="font-size: 10.00px;">network</a><a href="/tags/php_modules/" style="font-size: 15.00px;">php_modules</a><a href="/tags/php_problem/" style="font-size: 15.00px;">php_problem</a><a href="/tags/puppet/" style="font-size: 15.00px;">puppet</a><a href="/tags/script/" style="font-size: 10.00px;">script</a><a href="/tags/security/" style="font-size: 10.00px;">security</a><a href="/tags/virtualization/" style="font-size: 10.00px;">virtualization</a><a href="/tags/生活领悟/" style="font-size: 10.00px;">生活领悟</a>
  </div>
</div>


  <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=3085731643&verifier=23a4d229&dpc=1"></iframe> 

  <div class="widget tag">
<h3 class="title">友情链接</h3>
<ul class="entry">
<li><a href="http://zipperary.com/" title="Zippera's Blog">Zippera</a></li>
<li><a href="http://kisspuppet.com/" title="kisspuppet's Blog">KissPuppet</a></li>
</ul>
</div>
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 Copyright By Qun.Xue  版权所有
  
</div>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcdde601af19137391abfb46341775e4d' type='text/javascript'%3E%3C/script%3E"));
</script>

<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>